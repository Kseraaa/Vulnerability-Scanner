from jinja2 import Environment, FileSystemLoader
from Vulnerability import scan_data
import weasyprint

def create_report(scan_data):
    env = Environment(loader=FileSystemLoader('templates'))
    template = env.get_template('report.html')
    html_out = template.render(scan_data=scan_data)

    # Save as HTML file
    with open('scan_report.html', 'w') as f:
        f.write(html_out)

    # Convert to PDF
    weasyprint.HTML('scan_report.html').write_pdf('scan_report.pdf')


# สร้างรายงานจากข้อมูลการสแกน
create_report(scan_data)
